<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - ROCKET PC</title>
    <link rel="stylesheet" href="{{ url_for('static', path='/css/dashboard.css') }}">

    <!-- –ù–ï–ú–ï–î–õ–ï–ù–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –¢–û–ö–ï–ù–ê -->
    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω –î–û –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        console.log('üîç –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞...');

        const token = localStorage.getItem('access_token');
        if (!token) {
            console.log('‚ùå –¢–æ–∫–µ–Ω–∞ –Ω–µ—Ç, –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–µ–¥–∏—Ä–µ–∫—Ç');
            window.location.replace('/auth/login');
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –¥–∞–ª—å–Ω–µ–π—à—É—é –∑–∞–≥—Ä—É–∑–∫—É
            document.documentElement.style.display = 'none';
        } else {
            console.log('‚úÖ –¢–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É');
        }
    </script>
</head>
<body style="display: none;" id="pageBody">
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="authCheckLoader" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        color: #00ffff;
        flex-direction: column;
        gap: 20px;
    ">
        <div class="logo" style="
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #00ffff, #0099ff);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            animation: pulse 2s ease-in-out infinite;
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.3);
        ">üöÄ</div>
        <h2 style="margin: 0; background: linear-gradient(45deg, #00ffff, #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
            ROCKET PC
        </h2>
        <div class="loading" style="
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 255, 255, 0.3);
            border-top-color: #00ffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        "></div>
        <p style="margin: 0; color: rgba(255, 255, 255, 0.7);">–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞...</p>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div id="dashboardContent" style="display: none;">
        <div class="bg-animation"></div>
        <button class="mobile-menu-toggle" onclick="toggleSidebar()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>

        <div class="dashboard-layout">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <div class="logo">üöÄ</div>
                    <h2>ROCKET PC</h2>
                </div>

                <nav>
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <a href="/dashboard" class="nav-link active">
                                <span class="nav-icon">üìä</span>
                                <span>–ì–ª–∞–≤–Ω–∞—è</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/dashboard/requests" class="nav-link">
                                <span class="nav-icon">üìù</span>
                                <span>–ó–∞—è–≤–∫–∏</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/dashboard/clients" class="nav-link">
                                <span class="nav-icon">üë•</span>
                                <span>–ö–ª–∏–µ–Ω—Ç—ã</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/dashboard/inventory" class="nav-link">
                                <span class="nav-icon">üì¶</span>
                                <span>–°–∫–ª–∞–¥</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/dashboard/statistics" class="nav-link">
                                <span class="nav-icon">üìà</span>
                                <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                            </a>
                        </li>
                        <li class="nav-item" id="usersMenuItem" style="display: none;">
                            <a href="/dashboard/users" class="nav-link">
                                <span class="nav-icon">üë§</span>
                                <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/dashboard/settings" class="nav-link">
                                <span class="nav-icon">‚öôÔ∏è</span>
                                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#logout" class="nav-link">
                                <span class="nav-icon">üö™</span>
                                <span>–í—ã—Ö–æ–¥</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Header -->
                <header class="header">
                    <div class="header-title">
                        <h1>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
                        <p class="header-subtitle">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ROCKET PC</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-outline tooltip" data-tooltip="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">
                            <span>üîî</span>
                        </button>
                        <div class="user-info">
                            <div class="user-avatar" id="userAvatar">–ê</div>
                            <div>
                                <div class="user-name" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                                <div class="user-role" id="userRole" style="font-size: 0.85rem; color: rgba(255,255,255,0.6);">...</div>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Stats Grid -->
                <div class="stats-grid fade-in">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">üìã</div>
                        </div>
                        <div class="stat-value" id="activeRequestsCount">0</div>
                        <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫</div>
                        <div class="stat-change">
                            <span>‚Üë</span> +12% –∑–∞ –Ω–µ–¥–µ–ª—é
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">‚úÖ</div>
                        </div>
                        <div class="stat-value" id="completedRequestsCount">0</div>
                        <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞ –º–µ—Å—è—Ü</div>
                        <div class="stat-change">
                            <span>‚Üë</span> +8% –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">üí∞</div>
                        </div>
                        <div class="stat-value" id="monthlyRevenue">‚ÇΩ0</div>
                        <div class="stat-label">–î–æ—Ö–æ–¥ –∑–∞ –º–µ—Å—è—Ü</div>
                        <div class="stat-change">
                            <span>‚Üë</span> +23% –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">‚è±Ô∏è</div>
                        </div>
                        <div class="stat-value" id="avgRepairTime">0—á</div>
                        <div class="stat-label">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ä–µ–º–æ–Ω—Ç–∞</div>
                        <div class="stat-change negative">
                            <span>‚Üì</span> -15% –±—ã—Å—Ç—Ä–µ–µ
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-section fade-in">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫ –∑–∞ –Ω–µ–¥–µ–ª—é</h3>
                            <button class="btn btn-outline">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                        </div>
                        <div class="chart-placeholder">
                            <canvas id="weeklyChart" width="400" height="300"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">–°—Ç–∞—Ç—É—Å—ã –∑–∞—è–≤–æ–∫</h3>
                        </div>
                        <div class="chart-placeholder">
                            <canvas id="statusChart" width="300" height="300"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Requests -->
                <div class="recent-section fade-in">
                    <div class="section-header">
                        <h3 class="section-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏</h3>
                        <a href="/dashboard/requests" class="btn">–í—Å–µ –∑–∞—è–≤–∫–∏</a>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ö–ª–∏–µ–Ω—Ç</th>
                                    <th>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</th>
                                    <th>–ü—Ä–æ–±–ª–µ–º–∞</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–ú–∞—Å—Ç–µ—Ä</th>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="recentRequestsTable">
                                <tr>
                                    <td colspan="8" style="text-align: center; color: rgba(255,255,255,0.6);">
                                        <div class="loading" style="margin: 20px auto;"></div>
                                        –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <script src="{{ url_for('static', path='/js/dashboard.js') }}"></script>
</body>
</html>