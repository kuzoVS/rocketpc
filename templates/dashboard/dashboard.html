<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - ROCKET PC</title>
    <link rel="stylesheet" href="{{ url_for('static', path='/css/dashboard.css') }}">

    <!-- –ù–ï–ú–ï–î–õ–ï–ù–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –¢–û–ö–ï–ù–ê -->
    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω –î–û –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        console.log('üîç –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞...');

        const token = localStorage.getItem('access_token');
        if (!token) {
            console.log('‚ùå –¢–æ–∫–µ–Ω–∞ –Ω–µ—Ç, –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–µ–¥–∏—Ä–µ–∫—Ç');
            window.location.replace('/auth/login');
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –¥–∞–ª—å–Ω–µ–π—à—É—é –∑–∞–≥—Ä—É–∑–∫—É
            document.documentElement.style.display = 'none';
        } else {
            console.log('‚úÖ –¢–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É');
        }
    </script>
</head>
<body style="display: none;" id="pageBody">
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="authCheckLoader" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        color: #00ffff;
        flex-direction: column;
        gap: 20px;
    ">
        <div class="logo" style="
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #00ffff, #0099ff);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            animation: pulse 2s ease-in-out infinite;
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.3);
        ">üöÄ</div>
        <h2 style="margin: 0; background: linear-gradient(45deg, #00ffff, #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
            ROCKET PC
        </h2>
        <div class="loading" style="
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 255, 255, 0.3);
            border-top-color: #00ffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        "></div>
        <p style="margin: 0; color: rgba(255, 255, 255, 0.7);">–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞...</p>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div id="dashboardContent" style="display: none;">
        <div class="bg-animation"></div>
        <button class="mobile-menu-toggle" onclick="toggleSidebar()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>

        <div class="dashboard-layout">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <div class="logo">üöÄ</div>
                    <h2>ROCKET PC</h2>
                </div>

                <nav>
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <a href="/dashboard" class="nav-link active">
                                <span class="nav-icon">üìä</span>
                                <span>–ì–ª–∞–≤–Ω–∞—è</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/dashboard/requests" class="nav-link">
                                <span class="nav-icon">üìù</span>
                                <span>–ó–∞—è–≤–∫–∏</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/dashboard/clients" class="nav-link">
                                <span class="nav-icon">üë•</span>
                                <span>–ö–ª–∏–µ–Ω—Ç—ã</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/dashboard/inventory" class="nav-link">
                                <span class="nav-icon">üì¶</span>
                                <span>–°–∫–ª–∞–¥</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/dashboard/statistics" class="nav-link">
                                <span class="nav-icon">üìà</span>
                                <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                            </a>
                        </li>
                        <li class="nav-item" id="usersMenuItem" style="display: none;">
                            <a href="/dashboard/users" class="nav-link">
                                <span class="nav-icon">üë§</span>
                                <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/dashboard/settings" class="nav-link">
                                <span class="nav-icon">‚öôÔ∏è</span>
                                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#logout" class="nav-link">
                                <span class="nav-icon">üö™</span>
                                <span>–í—ã—Ö–æ–¥</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Header -->
                <header class="header">
                    <div class="header-title">
                        <h1>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
                        <p class="header-subtitle">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ROCKET PC</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-outline tooltip" data-tooltip="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">
                            <span>üîî</span>
                        </button>
                        <div class="user-info">
                            <div class="user-avatar" id="userAvatar">–ê</div>
                            <div>
                                <div class="user-name" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                                <div class="user-role" id="userRole" style="font-size: 0.85rem; color: rgba(255,255,255,0.6);">...</div>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Stats Grid -->
                <div class="stats-grid fade-in">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">üìã</div>
                        </div>
                        <div class="stat-value" id="activeRequestsCount">0</div>
                        <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫</div>
                        <div class="stat-change">
                            <span>‚Üë</span> +12% –∑–∞ –Ω–µ–¥–µ–ª—é
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">‚úÖ</div>
                        </div>
                        <div class="stat-value" id="completedRequestsCount">0</div>
                        <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞ –º–µ—Å—è—Ü</div>
                        <div class="stat-change">
                            <span>‚Üë</span> +8% –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">üí∞</div>
                        </div>
                        <div class="stat-value" id="monthlyRevenue">‚ÇΩ0</div>
                        <div class="stat-label">–î–æ—Ö–æ–¥ –∑–∞ –º–µ—Å—è—Ü</div>
                        <div class="stat-change">
                            <span>‚Üë</span> +23% –∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">‚è±Ô∏è</div>
                        </div>
                        <div class="stat-value" id="avgRepairTime">0—á</div>
                        <div class="stat-label">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ä–µ–º–æ–Ω—Ç–∞</div>
                        <div class="stat-change negative">
                            <span>‚Üì</span> -15% –±—ã—Å—Ç—Ä–µ–µ
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-section fade-in">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫ –∑–∞ –Ω–µ–¥–µ–ª—é</h3>
                            <button class="btn btn-outline">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                        </div>
                        <div class="chart-placeholder">
                            <canvas id="weeklyChart" width="400" height="300"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">–°—Ç–∞—Ç—É—Å—ã –∑–∞—è–≤–æ–∫</h3>
                        </div>
                        <div class="chart-placeholder">
                            <canvas id="statusChart" width="300" height="300"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Requests -->
                <div class="recent-section fade-in">
                    <div class="section-header">
                        <h3 class="section-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏</h3>
                        <a href="/dashboard/requests" class="btn">–í—Å–µ –∑–∞—è–≤–∫–∏</a>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ö–ª–∏–µ–Ω—Ç</th>
                                    <th>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</th>
                                    <th>–ü—Ä–æ–±–ª–µ–º–∞</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–ú–∞—Å—Ç–µ—Ä</th>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="recentRequestsTable">
                                <tr>
                                    <td colspan="8" style="text-align: center; color: rgba(255,255,255,0.6);">
                                        <div class="loading" style="margin: 20px auto;"></div>
                                        –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- –°–ö–†–ò–ü–¢ –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò –ò –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò -->
    <script>
        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        async function initializeDashboard() {
            console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è dashboard...');

            const token = localStorage.getItem('access_token');
            if (!token) {
                console.log('‚ùå –¢–æ–∫–µ–Ω–∞ –Ω–µ—Ç –≤ localStorage');
                redirectToLogin();
                return;
            }

            try {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º body
                document.getElementById('pageBody').style.display = 'block';

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞
                console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞...');
                const response = await fetch('/auth/profile', {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    console.log('‚ùå –¢–æ–∫–µ–Ω –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω');
                    clearTokensAndRedirect();
                    return;
                }

                const userData = await response.json();
                console.log('‚úÖ –¢–æ–∫–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', userData.username);

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                loadUserInfo();

                // –°–∫—Ä—ã–≤–∞–µ–º loader –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
                hideLoaderAndShowContent();

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                await loadDashboardData();

                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≥—Ä–∞—Ñ–∏–∫–∏
                setTimeout(() => {
                    drawWeeklyChart();
                    drawStatusChart();
                }, 500);

            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                clearTokensAndRedirect();
            }
        }

        function redirectToLogin() {
            console.log('üö™ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ login...');
            window.location.replace('/auth/login');
        }

        function clearTokensAndRedirect() {
            localStorage.removeItem('access_token');
            localStorage.removeItem('user');
            redirectToLogin();
        }

        function hideLoaderAndShowContent() {
            console.log('üëÅÔ∏è –ü–æ–∫–∞–∑—ã–≤–∞–µ–º dashboard –∫–æ–Ω—Ç–µ–Ω—Ç...');

            const loader = document.getElementById('authCheckLoader');
            const content = document.getElementById('dashboardContent');

            if (loader) loader.style.display = 'none';
            if (content) content.style.display = 'block';
        }

        function loadUserInfo() {
            try {
                const user = JSON.parse(localStorage.getItem('user') || '{}');
                console.log('üë§ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:', user.username);

                const userName = document.getElementById('userName');
                const userRole = document.getElementById('userRole');
                const userAvatar = document.getElementById('userAvatar');

                if (userName && user.full_name) {
                    userName.textContent = user.full_name;
                }

                if (userRole && user.role) {
                    const roleMap = {
                        'admin': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                        'director': '–î–∏—Ä–µ–∫—Ç–æ—Ä',
                        'manager': '–ú–µ–Ω–µ–¥–∂–µ—Ä',
                        'master': '–ú–∞—Å—Ç–µ—Ä'
                    };
                    userRole.textContent = roleMap[user.role] || user.role;
                }

                if (userAvatar && user.full_name) {
                    userAvatar.textContent = user.full_name.charAt(0).toUpperCase();
                }

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—É–Ω–∫—Ç "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏" –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
                if (user.role === 'admin' || user.role === 'director') {
                    const usersMenuItem = document.getElementById('usersMenuItem');
                    if (usersMenuItem) usersMenuItem.style.display = 'block';
                }

            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:', error);
            }
        }

        async function loadDashboardData() {
            console.log('üìä –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö dashboard...');

            const token = localStorage.getItem('access_token');
            if (!token) return;

            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞—è–≤–∫–∏
                const response = await fetch('/dashboard/api/requests', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (response.status === 401) {
                    clearTokensAndRedirect();
                    return;
                }

                if (response.ok) {
                    const requests = await response.json();
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', requests.length, '–∑–∞—è–≤–æ–∫');

                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    updateStats(requests);

                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
                    updateRequestsTable(requests.slice(0, 5));
                } else {
                    console.log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º demo');
                    showDemoData();
                }
            } catch (error) {
                console.log('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º demo data');
                showDemoData();
            }
        }

        function updateStats(requests) {
            const activeCount = requests.filter(r => r.status !== '–í—ã–¥–∞–Ω–∞').length;
            const completedCount = requests.filter(r => r.status === '–í—ã–¥–∞–Ω–∞').length;

            document.getElementById('activeRequestsCount').textContent = activeCount;
            document.getElementById('completedRequestsCount').textContent = completedCount;
            document.getElementById('monthlyRevenue').textContent = `‚ÇΩ${(completedCount * 5000).toLocaleString()}`;
            document.getElementById('avgRepairTime').textContent = '3—á';
        }

        function updateRequestsTable(requests) {
            const tbody = document.getElementById('recentRequestsTable');
            if (!tbody || !requests.length) {
                showDemoData();
                return;
            }

            tbody.innerHTML = requests.map(request => `
                <tr>
                    <td>#${request.request_id || 'N/A'}</td>
                    <td>${request.client_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</td>
                    <td>${request.device_type || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</td>
                    <td>${(request.problem_description || '–ù–µ —É–∫–∞–∑–∞–Ω–æ').substring(0, 30)}...</td>
                    <td><span class="status-badge status-new">${request.status || '–ü—Ä–∏–Ω—è—Ç–∞'}</span></td>
                    <td>${request.master_name || '-'}</td>
                    <td>${request.created_at ? new Date(request.created_at).toLocaleDateString('ru-RU') : 'N/A'}</td>
                    <td><button class="btn btn-outline" style="padding: 0.25rem 0.5rem; font-size: 0.85rem;">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button></td>
                </tr>
            `).join('');
        }

        function showDemoData() {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º demo —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('activeRequestsCount').textContent = '12';
            document.getElementById('completedRequestsCount').textContent = '85';
            document.getElementById('monthlyRevenue').textContent = '‚ÇΩ425 000';
            document.getElementById('avgRepairTime').textContent = '3—á';

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º demo —Ç–∞–±–ª–∏—Ü—É
            const tbody = document.getElementById('recentRequestsTable');
            if (tbody) {
                tbody.innerHTML = `
                    <tr>
                        <td>#RQ2A4F</td>
                        <td>–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤</td>
                        <td>–ù–æ—É—Ç–±—É–∫ ASUS</td>
                        <td>–ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è</td>
                        <td><span class="status-badge status-new">–ü—Ä–∏–Ω—è—Ç–∞</span></td>
                        <td>-</td>
                        <td>30.05.2025</td>
                        <td><button class="btn btn-outline" style="padding: 0.25rem 0.5rem; font-size: 0.85rem;">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button></td>
                    </tr>
                    <tr>
                        <td>#RQ1B3E</td>
                        <td>–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞</td>
                        <td>–ü–ö</td>
                        <td>–ü–µ—Ä–µ–≥—Ä–µ–≤–∞–µ—Ç—Å—è</td>
                        <td><span class="status-badge status-in-progress">–í —Ä–µ–º–æ–Ω—Ç–µ</span></td>
                        <td>–ê–ª–µ–∫—Å–µ–π</td>
                        <td>29.05.2025</td>
                        <td><button class="btn btn-outline" style="padding: 0.25rem 0.5rem; font-size: 0.85rem;">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button></td>
                    </tr>
                `;
            }
        }

        function drawWeeklyChart() {
            const canvas = document.getElementById('weeklyChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            ctx.fillStyle = "#00ffff";
            ctx.font = "16px Arial";
            ctx.fillText("–ì—Ä–∞—Ñ–∏–∫ –∑–∞—è–≤–æ–∫ –∑–∞ –Ω–µ–¥–µ–ª—é", 20, 30);
            ctx.fillText("(–¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ)", 20, 60);
        }

        function drawStatusChart() {
            const canvas = document.getElementById('statusChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            ctx.fillStyle = "#00ffff";
            ctx.font = "16px Arial";
            ctx.fillText("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º", 20, 30);
            ctx.fillText("(–¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ)", 20, 60);
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            if (sidebar) sidebar.classList.toggle('active');
        }

        function logout() {
            console.log('üö™ –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
            localStorage.removeItem('access_token');
            localStorage.removeItem('user');
            window.location.replace('/auth/login');
        }

        // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.addEventListener('DOMContentLoaded', function() {
            const logoutLinks = document.querySelectorAll('a[href="#logout"]');
            logoutLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    logout();
                });
            });
        });

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
        document.addEventListener('DOMContentLoaded', initializeDashboard);

        console.log('‚úÖ Dashboard —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω');
    </script>
</body>
</html>