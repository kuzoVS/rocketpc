<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ - ROCKET PC</title>
    <link rel="stylesheet" href="{{ url_for('static', path='/css/dashboard.css') }}">

    <script>
        document.addEventListener("DOMContentLoaded", () => {
        document.getElementById('pageBody').style.display = 'block';
    });
    </script>

    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞—è–≤–æ–∫ */
        .filters-section {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            align-items: end;
        }

        .search-box {
            position: relative;
        }

        .search-box input {
            padding-left: 40px;
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.5);
        }

        .table-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-sm {
            padding: 0.25rem 0.75rem;
            font-size: 0.85rem;
        }

        .btn-icon {
            padding: 0.5rem;
            width: 36px;
            height: 36px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
        }

        .btn-edit {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .btn-delete {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        .priority-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(0, 255, 255, 0.2);
        }

        .modal-title {
            font-size: 1.5rem;
            color: #00ffff;
        }

        .close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 1.5rem;
            cursor: pointer;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #ff4444;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .info-item {
            padding: 1rem;
            background: rgba(0, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(0, 255, 255, 0.1);
        }

        .info-label {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 0.25rem;
        }

        .info-value {
            font-size: 1.1rem;
            color: #00ffff;
        }

        .modal-footer {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(0, 255, 255, 0.2);
        }

        /* –°—Ç–∞—Ç—É—Å—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ */
        .status-select {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .status-option {
            padding: 0.5rem 1rem;
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 20px;
            background: transparent;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .status-option:hover {
            background: rgba(0, 255, 255, 0.1);
            border-color: #00ffff;
        }

        .status-option.active {
            background: rgba(0, 255, 255, 0.2);
            color: #00ffff;
            border-color: #00ffff;
        }

        #pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(0, 255, 255, 0.2);
        }

        .page-btn {
            padding: 0.5rem 1rem;
            background: transparent;
            border: 1px solid rgba(0, 255, 255, 0.3);
            color: #00ffff;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-btn:hover {
            background: rgba(0, 255, 255, 0.1);
            border-color: #00ffff;
        }

        .page-btn.active {
            background: linear-gradient(45deg, #00ffff, #0099ff);
            color: #000;
            border: none;
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.3);
            color: #00ff00;
            border-radius: 12px;
            z-index: 3000;
            animation: slideInRight 0.4s ease-out;
        }

        .notification.error {
            background: rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.3);
            color: #ff4444;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body style="display: none;" id="pageBody">
    <div class="bg-animation"></div>

    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </button>

    <div class="dashboard-layout">
        <!-- Sidebar -->
        {% include "dashboard/sidebar.html" %}
        <!-- Main Content -->
        <main class="main-content">
            <header class="header">
                <div class="header-title">
                    <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏</h1>
                    <p class="header-subtitle">–í—Å–µ –∑–∞—è–≤–∫–∏ –Ω–∞ —Ä–µ–º–æ–Ω—Ç –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ</p>
                </div>
                <div class="header-actions">
                    <button class="btn" onclick="openNewRequestModal()">
                        ‚ûï –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞
                    </button>
                    <div class="user-info">
                        <div class="user-avatar" id="userAvatar">–ê</div>
                        <div>
                            <div class="user-name" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                            <div class="user-role" id="userRole" style="font-size: 0.85rem; color: rgba(255,255,255,0.6);">...</div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- –§–∏–ª—å—Ç—Ä—ã -->
            <div class="filters-section fade-in">
                <div class="filters-grid">
                    <div class="form-group">
                        <label>–ü–æ–∏—Å–∫</label>
                        <div class="search-box">
                            <span class="search-icon">üîç</span>
                            <input type="text" id="searchInput" placeholder="ID, –∫–ª–∏–µ–Ω—Ç, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ..."
                                   onkeyup="filterRequests()">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>–°—Ç–∞—Ç—É—Å</label>
                        <select id="statusFilter" onchange="filterRequests()">
                            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="–ü—Ä–∏–Ω—è—Ç–∞">–ü—Ä–∏–Ω—è—Ç–∞</option>
                            <option value="–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</option>
                            <option value="–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–µ–π">–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–µ–π</option>
                            <option value="–í —Ä–µ–º–æ–Ω—Ç–µ">–í —Ä–µ–º–æ–Ω—Ç–µ</option>
                            <option value="–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</option>
                            <option value="–ì–æ—Ç–æ–≤–∞ –∫ –≤—ã–¥–∞—á–µ">–ì–æ—Ç–æ–≤–∞ –∫ –≤—ã–¥–∞—á–µ</option>
                            <option value="–í—ã–¥–∞–Ω–∞">–í—ã–¥–∞–Ω–∞</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                        <select id="priorityFilter" onchange="filterRequests()">
                            <option value="">–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</option>
                            <option value="–ù–∏–∑–∫–∞—è">–ù–∏–∑–∫–∞—è</option>
                            <option value="–û–±—ã—á–Ω–∞—è">–û–±—ã—á–Ω–∞—è</option>
                            <option value="–í—ã—Å–æ–∫–∞—è">–í—ã—Å–æ–∫–∞—è</option>
                            <option value="–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ü–µ—Ä–∏–æ–¥</label>
                        <select id="periodFilter" onchange="filterRequests()">
                            <option value="">–í—Å–µ –≤—Ä–µ–º—è</option>
                            <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
                            <option value="week">–ù–µ–¥–µ–ª—è</option>
                            <option value="month">–ú–µ—Å—è—Ü</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞—è–≤–æ–∫ -->
            <div class="recent-section fade-in">
                <div class="section-header">
                    <h3 class="section-title">–°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫</h3>
                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-outline" onclick="loadRequests()">
                            üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                        <button class="btn btn-outline" onclick="exportRequests()">
                            üì• –≠–∫—Å–ø–æ—Ä—Ç
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <table id="requestsTable">
                        <thead>
                            <tr>
                                <th onclick="sortTable('id')">ID ‚ÜïÔ∏è</th>
                                <th onclick="sortTable('client')">–ö–ª–∏–µ–Ω—Ç ‚ÜïÔ∏è</th>
                                <th onclick="sortTable('device')">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ‚ÜïÔ∏è</th>
                                <th>–ü—Ä–æ–±–ª–µ–º–∞</th>
                                <th onclick="sortTable('status')">–°—Ç–∞—Ç—É—Å ‚ÜïÔ∏è</th>
                                <th onclick="sortTable('priority')">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚ÜïÔ∏è</th>
                                <th>–ú–∞—Å—Ç–µ—Ä</th>
                                <th onclick="sortTable('date')">–î–∞—Ç–∞ ‚ÜïÔ∏è</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="requestsTableBody">
                            <tr>
                                <td colspan="9" style="text-align: center; padding: 3rem;">
                                    <div class="loading"></div>
                                    –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
                <div id="pagination"></div>
            </div>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ -->
    <div id="newRequestModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title">–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</h2>
                <button class="close" onclick="closeModal('newRequestModal')">√ó</button>
            </div>

            <form id="newRequestForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞ *</label>
                        <input type="text" id="clientName" required>
                    </div>
                    <div class="form-group">
                        <label>–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                        <input type="tel" id="clientPhone" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="clientEmail">
                    </div>
                    <div class="form-group">
                        <label>–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ *</label>
                        <select id="deviceType" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
                            <option value="–ù–∞—Å—Ç–æ–ª—å–Ω—ã–π –ü–ö">–ù–∞—Å—Ç–æ–ª—å–Ω—ã–π –ü–ö</option>
                            <option value="–ù–æ—É—Ç–±—É–∫">–ù–æ—É—Ç–±—É–∫</option>
                            <option value="–ú–æ–Ω–æ–±–ª–æ–∫">–ú–æ–Ω–æ–±–ª–æ–∫</option>
                            <option value="–°–µ—Ä–≤–µ—Ä">–°–µ—Ä–≤–µ—Ä</option>
                            <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>–ë—Ä–µ–Ω–¥</label>
                        <input type="text" id="deviceBrand" placeholder="ASUS, HP, Dell...">
                    </div>
                    <div class="form-group">
                        <label>–ú–æ–¥–µ–ª—å</label>
                        <input type="text" id="deviceModel">
                    </div>
                </div>

                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã *</label>
                    <textarea id="problemDescription" rows="4" required></textarea>
                </div>

                <div class="form-group">
                    <label>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                    <div class="status-select">
                        <button type="button" class="status-option" onclick="setPriority(this, '–ù–∏–∑–∫–∞—è')">–ù–∏–∑–∫–∞—è</button>
                        <button type="button" class="status-option active" onclick="setPriority(this, '–û–±—ã—á–Ω–∞—è')">–û–±—ã—á–Ω–∞—è</button>
                        <button type="button" class="status-option" onclick="setPriority(this, '–í—ã—Å–æ–∫–∞—è')">–í—ã—Å–æ–∫–∞—è</button>
                        <button type="button" class="status-option" onclick="setPriority(this, '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è')">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è</button>
                    </div>
                    <input type="hidden" id="priority" value="–û–±—ã—á–Ω–∞—è">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-outline" onclick="closeModal('newRequestModal')">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn">
                        –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ -->
    <div id="editRequestModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏</h2>
                <button class="close" onclick="closeModal('editRequestModal')">√ó</button>
            </div>

            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">ID –∑–∞—è–≤–∫–∏</div>
                    <div class="info-value" id="editRequestId">-</div>
                </div>
                <div class="info-item">
                    <div class="info-label">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</div>
                    <div class="info-value" id="editCreatedAt">-</div>
                </div>
                <div class="info-item">
                    <div class="info-label">–ö–ª–∏–µ–Ω—Ç</div>
                    <div class="info-value" id="editClientInfo">-</div>
                </div>
                <div class="info-item">
                    <div class="info-label">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</div>
                    <div class="info-value" id="editDeviceInfo">-</div>
                </div>
            </div>

            <form id="editRequestForm">
                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</label>
                    <textarea id="editProblemDescription" rows="4"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>–°—Ç–∞—Ç—É—Å *</label>
                        <select id="editStatus" required>
                            <option value="–ü—Ä–∏–Ω—è—Ç–∞">–ü—Ä–∏–Ω—è—Ç–∞</option>
                            <option value="–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</option>
                            <option value="–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–µ–π">–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–µ–π</option>
                            <option value="–í —Ä–µ–º–æ–Ω—Ç–µ">–í —Ä–µ–º–æ–Ω—Ç–µ</option>
                            <option value="–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</option>
                            <option value="–ì–æ—Ç–æ–≤–∞ –∫ –≤—ã–¥–∞—á–µ">–ì–æ—Ç–æ–≤–∞ –∫ –≤—ã–¥–∞—á–µ</option>
                            <option value="–í—ã–¥–∞–Ω–∞">–í—ã–¥–∞–Ω–∞</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                        <select id="editPriority">
                            <option value="–ù–∏–∑–∫–∞—è">–ù–∏–∑–∫–∞—è</option>
                            <option value="–û–±—ã—á–Ω–∞—è">–û–±—ã—á–Ω–∞—è</option>
                            <option value="–í—ã—Å–æ–∫–∞—è">–í—ã—Å–æ–∫–∞—è</option>
                            <option value="–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>–ú–∞—Å—Ç–µ—Ä</label>
                        <select id="editMaster">
                            <option value="">–ó–∞–≥—Ä—É–∑–∫–∞ –º–∞—Å—Ç–µ—Ä–æ–≤...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</label>
                        <input type="number" id="editEstimatedCost" placeholder="0">
                    </div>
                </div>

                <div class="form-group">
                    <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é</label>
                    <textarea id="editComment" rows="2" placeholder="–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞..."></textarea>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-outline" onclick="closeModal('editRequestModal')">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', path='/js/requests.js') }}?v=2"></script>
</body>
</html>